% generated from JIRA project LVV
% using template at /Users/GComoretto/anaconda3/envs/docsteady/lib/python3.7/site-packages/docsteady/templates/dm-spec.latex.jinja2.
% Collecting ATM data from folder: "/Data Management/Software Products/Supporting SW/Distrib Database|LDM-552"
% using docsteady version 1.2rc2
% Please do not edit -- update information in Jira instead

\section{Test Cases Summary}\label{test-cases-summary}

\begin{longtable}[]{p{3cm}p{13cm}}
\toprule
Test Id & Test Name\tabularnewline
\midrule
\endhead
    \hyperref[lvv-t1013]{LVV-T1013} &
    \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1013}{QSERV-VER-00-00: Qserv design inspection} \tabularnewline
    \hyperref[lvv-t1014]{LVV-T1014} &
    \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1014}{QSERV-VER-00-10: Qserv test inspection} \tabularnewline
    \hyperref[lvv-t1015]{LVV-T1015} &
    \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1015}{QSERV-VER-00-05: Qserv code inspection} \tabularnewline
    \hyperref[lvv-t1016]{LVV-T1016} &
    \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1016}{QSERV-PRF-20-00: Object Shared Scan Scaling} \tabularnewline
    \hyperref[lvv-t1017]{LVV-T1017} &
    \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1017}{QSERV Preparation} \tabularnewline
    \hyperref[lvv-t1018]{LVV-T1018} &
    \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1018}{Procedure QSERV-PRF-SCAN-SCALE-TEST} \tabularnewline
    \hyperref[lvv-t1019]{LVV-T1019} &
    \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1019}{QSERV-PRF-20-05: Source Shared Scan Scaling} \tabularnewline
    \hyperref[lvv-t1020]{LVV-T1020} &
    \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1020}{QSERV-PRF-20-10: Object Source Join Shared Scan Scaling} \tabularnewline
    \hyperref[lvv-t1021]{LVV-T1021} &
    \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1021}{QSERV-PRF-20-15: Object ForcedSource Join Shared Scan Scaling} \tabularnewline
    \hyperref[lvv-t1022]{LVV-T1022} &
    \href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1022}{QSERV-PRF-10-00: Concurrent Query Performance} \tabularnewline
\bottomrule
\end{longtable}

\newpage

\section{Test Cases}

\subsection{\href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1013}{LVV-T1013}
    - QSERV-VER-00-00: Qserv design inspection}\label{lvv-t1013}

\begin{longtable}[]{llllll}
\toprule
Version & Status & Priority & Verification Type & Owner
\\\midrule
1 & Approved & Normal &
Inspection & Fritz Mueller
\\\bottomrule
\end{longtable}

\subsubsection{Verification Elements}
    None.

\subsubsection{Test Items}
This test will check that the design of QSERV is adequate to meet the DM
subsystem requirements\\
~\\



\subsubsection{Predecessors}

\subsubsection{Environment Needs}

\paragraph{Software}

\paragraph{Hardware}

\subsubsection{Input Specification}

\subsubsection{Output Specification}

\subsubsection{Test Procedure}
    \begin{longtable}[]{p{1.3cm}p{2cm}p{13cm}}
    %\toprule
    Step & \multicolumn{2}{@{}l}{Description, Input Data and Expected Result} \\ \toprule
    \endhead

            \multirow{3}{*}{ 1 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            By reference to {LDM-135}, the Qserv design document, and LDM-555, the
Qserv requirements document, demonstrate that elements exist in the
design as stated to address each of individual requirements

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule
    \end{longtable}

\subsection{\href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1014}{LVV-T1014}
    - QSERV-VER-00-10: Qserv test inspection}\label{lvv-t1014}

\begin{longtable}[]{llllll}
\toprule
Version & Status & Priority & Verification Type & Owner
\\\midrule
1 & Approved & Normal &
Test & Fritz Mueller
\\\bottomrule
\end{longtable}

\subsubsection{Verification Elements}
    None.

\subsubsection{Test Items}
This test will check:\\

\begin{itemize}
\tightlist
\item
  That all automated test suites associated with the product pass;
\item
  That there are no unexpected errors or warnings from the build, test
  or installation process.
\end{itemize}



\subsubsection{Predecessors}
LVV-T1015(QSERV-VER-00-05)


\subsubsection{Environment Needs}

\paragraph{Software}

\paragraph{Hardware}

\subsubsection{Input Specification}

\subsubsection{Output Specification}

\subsubsection{Test Procedure}
    \begin{longtable}[]{p{1.3cm}p{2cm}p{13cm}}
    %\toprule
    Step & \multicolumn{2}{@{}l}{Description, Input Data and Expected Result} \\ \toprule
    \endhead

            \multirow{3}{*}{ 1 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            Successful execution of the test suite, with no failures and no tests
being skipped without explanatory documentation

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule

            \multirow{3}{*}{ 2 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            That there were no compiler, test, linter or other warnings associated
with the software build processing

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule
    \end{longtable}

\subsection{\href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1015}{LVV-T1015}
    - QSERV-VER-00-05: Qserv code inspection}\label{lvv-t1015}

\begin{longtable}[]{llllll}
\toprule
Version & Status & Priority & Verification Type & Owner
\\\midrule
1 & Approved & Normal &
Inspection & Fritz Mueller
\\\bottomrule
\end{longtable}

\subsubsection{Verification Elements}
    None.

\subsubsection{Test Items}
This test will check:

\begin{itemize}
\tightlist
\item
  That the code delivered complies with relevant DM software quality
  standards;
\item
  That the code is accompanied by appropriate documentation;
\item
  That the code makes use of appropriate DM interfaces to the rest of
  the system where applicable;
\item
  That the code is appropriately tested.
\end{itemize}



\subsubsection{Predecessors}

\subsubsection{Environment Needs}

\paragraph{Software}

\paragraph{Hardware}

\subsubsection{Input Specification}

\subsubsection{Output Specification}

\subsubsection{Test Procedure}
    \begin{longtable}[]{p{1.3cm}p{2cm}p{13cm}}
    %\toprule
    Step & \multicolumn{2}{@{}l}{Description, Input Data and Expected Result} \\ \toprule
    \endhead

            \multirow{3}{*}{ 1 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            Check for the existence of a suite of unit test cases accompanying the
codebase

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule

            \multirow{3}{*}{ 2 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            Check the code to demonstrate that uses only standardized DM interfaces
for such things as logging and configuration (i.e. it does not print
directly to screen nor does it contain ad-hoc configuration parsers)

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule

            \multirow{3}{*}{ 3 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            Check that the code is accompanied by a user manual describing
procedures for its installation and operation

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule
    \end{longtable}

\subsection{\href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1016}{LVV-T1016}
    - QSERV-PRF-20-00: Object Shared Scan Scaling}\label{lvv-t1016}

\begin{longtable}[]{llllll}
\toprule
Version & Status & Priority & Verification Type & Owner
\\\midrule
1 & Approved & Normal &
Test & Fritz Mueller
\\\bottomrule
\end{longtable}

\subsubsection{Verification Elements}
\begin{itemize}
\item \href{https://jira.lsstcorp.org/browse/LVV-188}{LVV-188} - DMS-REQ-0357-V-01: Result latency for high-volume full-sky queries on
the Object table

\end{itemize}

\subsubsection{Test Items}
This test will show that average completion-time of full-scan queries of
the Object catalog table grow\\
sub-linearly with respect to the number of simultaneously active
full-scan queries, within the limits of\\
machine resource exhaustion.



\subsubsection{Predecessors}

\subsubsection{Environment Needs}

\paragraph{Software}

\paragraph{Hardware}

\subsubsection{Input Specification}
\begin{itemize}
\tightlist
\item
  A test catalog of appropriate size (see schedule detail in
  ~QSERV-PRF-10), prepared and ingested into the QSERV instance under
  test as detailed in LVV-T1017.
\item
  The concurrency load execution script, runQueries.py, maintained in
  the LSST QSERV github repository here:
  https://github.com/lsst/qserv/blob/master/admin/tools/docker/deployment/in2p3/runQueries.py
\end{itemize}


\subsubsection{Output Specification}
Log files as generated by the runQueries.py test script


\subsubsection{Test Procedure}
    \begin{longtable}[]{p{1.3cm}p{2cm}p{13cm}}
    %\toprule
    Step & \multicolumn{2}{@{}l}{Description, Input Data and Expected Result} \\ \toprule
    \endhead

                \multirow{3}{*}{\parbox{1.3cm}{ 1-1
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Ensure that Qserv instance under test is up to date and that there is no
other concurrent user activity

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-2
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Inspect and modify the \emph{CONCURRENCY} and \emph{TARGET\_RATES}
dictionaries in the run-Queries.py script. Set \emph{CONCURRENCY}
initially to 1 for the query pool of interest, and to 0 for all other
query pools. ~Set \emph{TARGET\_RATES} for the query pool of interest to
the yearly value per table in QSERV-PRF-10-00.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-3
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Execute the runQueries.py script and let it run for at least one, but
preferably several, query cycles.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-4
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Examine log file output and compile performance statistics to obtain a
growth curve point for the pool of interest for the test report.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-5
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Adjust the \emph{CONCURRENCY} value for the pool of interest and repeat
from the previous step to establish the growth trend and machine
resource exhaustion cutoff for the query pool of interest to an
acceptable degree of accuracy.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


        \\ \midrule
    \end{longtable}

\subsection{\href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1017}{LVV-T1017}
    - QSERV Preparation}\label{lvv-t1017}

\begin{longtable}[]{llllll}
\toprule
Version & Status & Priority & Verification Type & Owner
\\\midrule
1 & Approved & Normal &
Test & Fritz Mueller
\\\bottomrule
\end{longtable}

\subsubsection{Verification Elements}
    None.

\subsubsection{Test Items}
Before running any of the performance test cases, Qserv must be
installed on an appropriate test cluster (e.g.\\
the test machine cluster at CC-IN2P3). ~To upgrade Qserv software on the
cluster in preparation for testing,\\
follow directions at
http://www.slac.stanford.edu/exp/lsst/qserv/2015\_10/HOW-TO/cluster-deployment.html.\\
~\\
The performance tests will also require an appropriately sized test
dataset to be synthesized and ingested,\\
per the yearly dataset sizing schedule described in LVV-T1022
(QSERV-PRF-10). ~Tools\\
for synthesis of ingest of test datasets may be found in the LSST github
repot at https://github.com/lsst-dm/db\_tests\_kpm20. ~Detailed use and
context information for the tools is described in
https://jira.lsstcorp.org/browse/DM-8405.\\
~\\
It has also been found that the Qserv shard servers must have
engine-independent statistics\\
loaded for the larger tables in the test dataset, and be properly\\
configured so that the MariaDB query planner can make use of those
statistics. ~More information on this\\
issue is avilable at
https://confluence.lsstcorp.org/pages/viewpage.action?pageId=58950786.



\subsubsection{Predecessors}

\subsubsection{Environment Needs}

\paragraph{Software}

\paragraph{Hardware}

\subsubsection{Input Specification}

\subsubsection{Output Specification}

\subsubsection{Test Procedure}
    \begin{longtable}[]{p{1.3cm}p{2cm}p{13cm}}
    %\toprule
    Step & \multicolumn{2}{@{}l}{Description, Input Data and Expected Result} \\ \toprule
    \endhead

            \multirow{3}{*}{ 1 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            
            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule
    \end{longtable}

\subsection{\href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1018}{LVV-T1018}
    - Procedure QSERV-PRF-SCAN-SCALE-TEST}\label{lvv-t1018}

\begin{longtable}[]{llllll}
\toprule
Version & Status & Priority & Verification Type & Owner
\\\midrule
1 & Approved & Normal &
Test & Fritz Mueller
\\\bottomrule
\end{longtable}

\subsubsection{Verification Elements}
    None.

\subsubsection{Test Items}
The objective of this procedure is to establish the growth trend for
average query execution time of\\
full-table-scan queries in the pool of interest, as a function of query
concurrency.~~The test shall\\
be considered passed if the growth rate is sub-linear (ideally, nearly
flat) within the limits of\\
machine resource exhaustion.



\subsubsection{Predecessors}

\subsubsection{Environment Needs}

\paragraph{Software}

\paragraph{Hardware}

\subsubsection{Input Specification}

\subsubsection{Output Specification}

\subsubsection{Test Procedure}
    \begin{longtable}[]{p{1.3cm}p{2cm}p{13cm}}
    %\toprule
    Step & \multicolumn{2}{@{}l}{Description, Input Data and Expected Result} \\ \toprule
    \endhead

            \multirow{3}{*}{ 1 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            Ensure that Qserv instance under test is up to date and that there is no
other concurrent user activity

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule

            \multirow{3}{*}{ 2 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            Inspect and modify the \emph{CONCURRENCY} and \emph{TARGET\_RATES}
dictionaries in the run-Queries.py script. Set \emph{CONCURRENCY}
initially to 1 for the query pool of interest, and to 0 for all other
query pools. ~Set \emph{TARGET\_RATES} for the query pool of interest to
the yearly value per table in QSERV-PRF-10-00.

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule

            \multirow{3}{*}{ 3 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            Execute the runQueries.py script and let it run for at least one, but
preferably several, query cycles.

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule

            \multirow{3}{*}{ 4 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            Examine log file output and compile performance statistics to obtain a
growth curve point for the pool of interest for the test report.

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule

            \multirow{3}{*}{ 5 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            Adjust the \emph{CONCURRENCY} value for the pool of interest and repeat
from the previous step to establish the growth trend and machine
resource exhaustion cutoff for the query pool of interest to an
acceptable degree of accuracy.

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule
    \end{longtable}

\subsection{\href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1019}{LVV-T1019}
    - QSERV-PRF-20-05: Source Shared Scan Scaling}\label{lvv-t1019}

\begin{longtable}[]{llllll}
\toprule
Version & Status & Priority & Verification Type & Owner
\\\midrule
1 & Approved & Normal &
Test & Fritz Mueller
\\\bottomrule
\end{longtable}

\subsubsection{Verification Elements}
\begin{itemize}
\item \href{https://jira.lsstcorp.org/browse/LVV-188}{LVV-188} - DMS-REQ-0357-V-01: Result latency for high-volume full-sky queries on
the Object table

\end{itemize}

\subsubsection{Test Items}
This test will show that average completion-time of full-scan queries of
the Source catalog table grow sub-linearly with respect to the number of
simultaneously active full-scan queries, within the limits of machine
resource exhaustion.



\subsubsection{Predecessors}

\subsubsection{Environment Needs}

\paragraph{Software}

\paragraph{Hardware}

\subsubsection{Input Specification}
\begin{itemize}
\tightlist
\item
  A test catalog of appropriate size (see schedule detail in
  QSERV-PRF-10), prepared and ingested into the
  \textbackslash{}product\{\} instance under test as detailed in
  LVV-T1017.
\item
  The concurrency load execution script, runQueries.py, maintained in
  the LSST QSERV github repository here:
  https://github.com/lsst/qserv/blob/master/admin/tools/docker/deployment/in2p3/runQueries.py
\end{itemize}


\subsubsection{Output Specification}
Log files as generated by the runQueries.py test script.


\subsubsection{Test Procedure}
    \begin{longtable}[]{p{1.3cm}p{2cm}p{13cm}}
    %\toprule
    Step & \multicolumn{2}{@{}l}{Description, Input Data and Expected Result} \\ \toprule
    \endhead

                \multirow{3}{*}{\parbox{1.3cm}{ 1-1
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Ensure that Qserv instance under test is up to date and that there is no
other concurrent user activity

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-2
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Inspect and modify the \emph{CONCURRENCY} and \emph{TARGET\_RATES}
dictionaries in the run-Queries.py script. Set \emph{CONCURRENCY}
initially to 1 for the query pool of interest, and to 0 for all other
query pools. ~Set \emph{TARGET\_RATES} for the query pool of interest to
the yearly value per table in QSERV-PRF-10-00.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-3
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Execute the runQueries.py script and let it run for at least one, but
preferably several, query cycles.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-4
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Examine log file output and compile performance statistics to obtain a
growth curve point for the pool of interest for the test report.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-5
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Adjust the \emph{CONCURRENCY} value for the pool of interest and repeat
from the previous step to establish the growth trend and machine
resource exhaustion cutoff for the query pool of interest to an
acceptable degree of accuracy.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


        \\ \midrule
    \end{longtable}

\subsection{\href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1020}{LVV-T1020}
    - QSERV-PRF-20-10: Object Source Join Shared Scan Scaling}\label{lvv-t1020}

\begin{longtable}[]{llllll}
\toprule
Version & Status & Priority & Verification Type & Owner
\\\midrule
1 & Approved & Normal &
Test & Fritz Mueller
\\\bottomrule
\end{longtable}

\subsubsection{Verification Elements}
\begin{itemize}
\item \href{https://jira.lsstcorp.org/browse/LVV-188}{LVV-188} - DMS-REQ-0357-V-01: Result latency for high-volume full-sky queries on
the Object table

\end{itemize}

\subsubsection{Test Items}
This test will show that average completion-time of full-scan queries
which join the Object and Source catalog tables grow sub-linearly with
respect to the number of simultaneously active full-scan queries, within
the limits of machine resource exhaustion.



\subsubsection{Predecessors}

\subsubsection{Environment Needs}

\paragraph{Software}

\paragraph{Hardware}

\subsubsection{Input Specification}
\begin{itemize}
\tightlist
\item
  A test catalog of appropriate size (see schedule detail in
  QSERV-PRF-10), prepared and ingested into the
  \textbackslash{}product\{\} instance under test as detailed in
  LVV-T1017.
\item
  The concurrency load execution script, runQueries.py, maintained in
  the LSST QSERV github repository here:
  https://github.com/lsst/qserv/blob/master/admin/tools/docker/deployment/in2p3/runQueries.py
\end{itemize}


\subsubsection{Output Specification}
Log files as generated by the runQueries.py test script


\subsubsection{Test Procedure}
    \begin{longtable}[]{p{1.3cm}p{2cm}p{13cm}}
    %\toprule
    Step & \multicolumn{2}{@{}l}{Description, Input Data and Expected Result} \\ \toprule
    \endhead

                \multirow{3}{*}{\parbox{1.3cm}{ 1-1
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Ensure that Qserv instance under test is up to date and that there is no
other concurrent user activity

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-2
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Inspect and modify the \emph{CONCURRENCY} and \emph{TARGET\_RATES}
dictionaries in the run-Queries.py script. Set \emph{CONCURRENCY}
initially to 1 for the query pool of interest, and to 0 for all other
query pools. ~Set \emph{TARGET\_RATES} for the query pool of interest to
the yearly value per table in QSERV-PRF-10-00.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-3
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Execute the runQueries.py script and let it run for at least one, but
preferably several, query cycles.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-4
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Examine log file output and compile performance statistics to obtain a
growth curve point for the pool of interest for the test report.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-5
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Adjust the \emph{CONCURRENCY} value for the pool of interest and repeat
from the previous step to establish the growth trend and machine
resource exhaustion cutoff for the query pool of interest to an
acceptable degree of accuracy.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


        \\ \midrule
    \end{longtable}

\subsection{\href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1021}{LVV-T1021}
    - QSERV-PRF-20-15: Object ForcedSource Join Shared Scan Scaling}\label{lvv-t1021}

\begin{longtable}[]{llllll}
\toprule
Version & Status & Priority & Verification Type & Owner
\\\midrule
1 & Approved & Normal &
Test & Fritz Mueller
\\\bottomrule
\end{longtable}

\subsubsection{Verification Elements}
\begin{itemize}
\item \href{https://jira.lsstcorp.org/browse/LVV-188}{LVV-188} - DMS-REQ-0357-V-01: Result latency for high-volume full-sky queries on
the Object table

\end{itemize}

\subsubsection{Test Items}
This test will show that average completion-time of full-scan queries
which join the Object and ForcedSource catalog tables grow sub-linearly
with respect to the number of simultaneously active full-scan queries,
within the limits of machine resource exhaustion.



\subsubsection{Predecessors}

\subsubsection{Environment Needs}

\paragraph{Software}

\paragraph{Hardware}

\subsubsection{Input Specification}
\begin{itemize}
\tightlist
\item
  A test catalog of appropriate size (see schedule detail in
  QSERV-PRF-10), prepared and ingested into the
  \textbackslash{}product\{\} instance under test as detailed in
  LVV-T1017.
\item
  The concurrency load execution script, runQueries.py, maintained in
  the LSST QSERV github repository here:
  https://github.com/lsst/qserv/blob/master/admin/tools/docker/deployment/in2p3/runQueries.py
\end{itemize}


\subsubsection{Output Specification}
Log files as generated by the runQueries.py test script.


\subsubsection{Test Procedure}
    \begin{longtable}[]{p{1.3cm}p{2cm}p{13cm}}
    %\toprule
    Step & \multicolumn{2}{@{}l}{Description, Input Data and Expected Result} \\ \toprule
    \endhead

                \multirow{3}{*}{\parbox{1.3cm}{ 1-1
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Ensure that Qserv instance under test is up to date and that there is no
other concurrent user activity

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-2
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Inspect and modify the \emph{CONCURRENCY} and \emph{TARGET\_RATES}
dictionaries in the run-Queries.py script. Set \emph{CONCURRENCY}
initially to 1 for the query pool of interest, and to 0 for all other
query pools. ~Set \emph{TARGET\_RATES} for the query pool of interest to
the yearly value per table in QSERV-PRF-10-00.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-3
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Execute the runQueries.py script and let it run for at least one, but
preferably several, query cycles.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-4
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Examine log file output and compile performance statistics to obtain a
growth curve point for the pool of interest for the test report.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


                \multirow{3}{*}{\parbox{1.3cm}{ 1-5
                {\scriptsize from \hyperref[lvv-t1018]
                {LVV-T1018} } } }

                & {\small Description} &
                \begin{minipage}[t]{13cm}{\scriptsize
                Adjust the \emph{CONCURRENCY} value for the pool of interest and repeat
from the previous step to establish the growth trend and machine
resource exhaustion cutoff for the query pool of interest to an
acceptable degree of accuracy.

                \vspace{\dp0}
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Test Data} &
                \begin{minipage}[t]{13cm}{\scriptsize
                } \end{minipage} \\ \cdashline{2-3}
                & {\small Expected Result} &
                \\ \hdashline


        \\ \midrule
    \end{longtable}

\subsection{\href{https://jira.lsstcorp.org/secure/Tests.jspa\#/testCase/LVV-T1022}{LVV-T1022}
    - QSERV-PRF-10-00: Concurrent Query Performance}\label{lvv-t1022}

\begin{longtable}[]{llllll}
\toprule
Version & Status & Priority & Verification Type & Owner
\\\midrule
1 & Approved & Normal &
Test & Fritz Mueller
\\\bottomrule
\end{longtable}

\subsubsection{Verification Elements}
\begin{itemize}
\item \href{https://jira.lsstcorp.org/browse/LVV-188}{LVV-188} - DMS-REQ-0357-V-01: Result latency for high-volume full-sky queries on
the Object table

\item \href{https://jira.lsstcorp.org/browse/LVV-187}{LVV-187} - DMS-REQ-0356-V-01: Radius for low-volume query

\end{itemize}

\subsubsection{Test Items}
This test will check that QSERV is able to meet average query completion
time targets per query class\\
under a representative load of simultaneous high and low volume queries
while running against an appropriately\\
scaled test catalog.



\subsubsection{Predecessors}
LVV-T1016, LVV-T1019, LVV-T1020, LVV-T1021


\subsubsection{Environment Needs}

\paragraph{Software}

\paragraph{Hardware}

\subsubsection{Input Specification}
\begin{itemize}
\tightlist
\item
  A test catalog of appropriate size (see schedule detail in
  QSERV-PRF-10), prepared and ingested into the
  \textbackslash{}product\{\} instance under test as detailed in
  LVV-T1017.
\item
  The concurrency load execution script, runQueries.py, maintained in
  the LSST QSERV github repository here:
  https://github.com/lsst/qserv/blob/master/admin/tools/docker/deployment/in2p3/runQueries.py
\end{itemize}


\subsubsection{Output Specification}
Log files as generated by the runQueries.py test script


\subsubsection{Test Procedure}
    \begin{longtable}[]{p{1.3cm}p{2cm}p{13cm}}
    %\toprule
    Step & \multicolumn{2}{@{}l}{Description, Input Data and Expected Result} \\ \toprule
    \endhead

            \multirow{3}{*}{ 1 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            Inspect and possibly modify the \emph{CONCURRENCY} and
\emph{TARGET\_RATES} dictionaries in the \emph{runQueries.py} script to
adjust the concurrency mix and target execution times per query class.
~Query mixes and target times are to be adjusted per the following
schedule:\\
~\\

Query Class

2015

2016

2017

2018

2019

2020

LV

\#queries\\

50

60

70

80

90

100\\

time(sec)

10

10

10

10

10

10

FTSObj

\#queries

3

4

8

12

16

20

time(hours)

12

1

1

1

1

1

FTSSrc

\#queries

1

1

2

3

4

5

time(hours)

12

12

12

12

12

12

FTSFSrc

\#queries\\

1

2

3

4

5

time(hours)\\

12

12

12

12

12

joinObjSrc

\#queries\\

1

2

4

6

8

10

time(hours)\\

12

12

12

12

12

12

joinObjFSrc

\#queries\\

1

2

3

4

5

time(hours)\\

12

12

12

12

12

nearN

\#queries\\

1

2

3

4

5

time(hours)\\

1

1

1

1

1

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule

            \multirow{3}{*}{ 2 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            Ensure that QSERV instance under test is up to date and that there is no
other concurrent user activity.\\
~\\

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule

            \multirow{3}{*}{ 3 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            Execute the runQueries.py script and let it run for at least 24hrs.

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule

            \multirow{3}{*}{ 4 } & Description &
            \begin{minipage}[t]{13cm}{\footnotesize
            Examine log file output and compile performance statistics for the test
report

            \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Test Data &
            \begin{minipage}[t]{13cm}{\footnotesize
                No data.
                \vspace{\dp0}
            } \end{minipage} \\ \cline{2-3}
            & Expected Result &
        \\ \midrule
    \end{longtable}

\appendix
